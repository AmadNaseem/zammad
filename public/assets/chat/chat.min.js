window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.agent=function(t){function e(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?i(t):""}var n=[],o=(t=t||{}).safe,i=t.escape,i=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},i||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){this.agent.avatar&&(n.push('\n<img class="zammad-chat-agent-avatar" src="'),n.push(e(this.agent.avatar)),n.push('">\n')),n.push('\n<span class="zammad-chat-agent-sentence">\n  <span class="zammad-chat-agent-name">'),n.push(e(this.agent.name)),n.push("</span>\n</span>")}.call(this)}.call(t),t.safe=o,t.escape=i,n.join("")},function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).DOMPurify=e()}(this,function(){"use strict";function Et(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return h(o,e)}var o,i=Object.hasOwnProperty,s=Object.setPrototypeOf,a=Object.isFrozen,r=Object.getPrototypeOf,l=Object.getOwnPropertyDescriptor,It=Object.freeze,t=Object.seal,c=Object.create,e="undefined"!=typeof Reflect&&Reflect,d=(d=e.apply)||function(t,e,n){return t.apply(e,n)},It=It||function(t){return t},t=t||function(t){return t},h=(h=e.construct)||function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e))))},Dt=u(Array.prototype.forEach),Rt=u(Array.prototype.pop),Lt=u(Array.prototype.push),Mt=u(String.prototype.toLowerCase),Nt=u(String.prototype.match),jt=u(String.prototype.replace),Ft=u(String.prototype.indexOf),te=u(String.prototype.trim),Ht=u(RegExp.prototype.test);o=TypeError;function u(i){return function(t){for(var e=arguments.length,n=Array(1<e?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return d(i,t,n)}}function Pt(t,e){s&&s(t,null);for(var n=e.length;n--;){var o,i=e[n];"string"!=typeof i||(o=Mt(i))!==i&&(a(e)||(e[n]=o),i=o),t[i]=!0}return t}function Bt(t){var e=c(null),n=void 0;for(n in t)d(i,t,[n])&&(e[n]=t[n]);return e}function Wt(t,e){for(;null!==t;){var n=l(t,e);if(n){if(n.get)return u(n.get);if("function"==typeof n.value)return u(n.value)}t=r(t)}return function(t){return console.warn("fallback value for",t),null}}var Ut=It(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),qt=It(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qt=It(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ee=It(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Vt=It(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ne=It(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Yt=It(["#text"]),Kt=It(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Gt=It(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Zt=It(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Xt=It(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oe=t(/\{\{[\s\S]*|[\s\S]*\}\}/gm),ie=t(/<%[\s\S]*|[\s\S]*%>/gm),se=t(/^data-[\-\w.\u00B7-\uFFFF]/),ae=t(/^aria-[\-\w]+$/),re=t(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),le=t(/^(?:\w+script|data):/i),ce=t(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),$t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function Jt(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}return function M(){var r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,c=function(t){return M(t)};if(c.version="2.3.1",c.removed=[],!r||!r.document||9!==r.document.nodeType)return c.isSupported=!1,c;var l=r.document,i=r.document,N=r.DocumentFragment,t=r.HTMLTemplateElement,d=r.Node,j=r.Element,e=r.NodeFilter,n=r.NamedNodeMap,F=void 0===n?r.NamedNodeMap||r.MozNamedAttrMap:n,H=r.Text,P=r.Comment,B=r.DOMParser,n=r.trustedTypes,o=j.prototype,W=Wt(o,"cloneNode"),U=Wt(o,"nextSibling"),q=Wt(o,"childNodes"),a=Wt(o,"parentNode"),h=("function"!=typeof t||(o=i.createElement("template")).content&&o.content.ownerDocument&&(i=o.content.ownerDocument),function(t,e){if("object"!==(void 0===t?"undefined":$t(t))||"function"!=typeof t.createPolicy)return null;var n=null,o="data-tt-policy-suffix",e="dompurify"+((n=e.currentScript&&e.currentScript.hasAttribute(o)?e.currentScript.getAttribute(o):n)?"#"+n:"");try{return t.createPolicy(e,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+e+" could not be created."),null}}(n,l)),Q=h&&A?h.createHTML(""):"",t=i,s=t.implementation,V=t.createNodeIterator,Y=t.createDocumentFragment,K=t.getElementsByTagName,G=l.importNode,o={};try{o=Bt(i).documentMode?i.documentMode:{}}catch(M){}function u(t){D&&D===t||(t=Bt(t=t&&"object"===(void 0===t?"undefined":$t(t))?t:{}),b="ALLOWED_TAGS"in t?Pt({},t.ALLOWED_TAGS):at,w="ALLOWED_ATTR"in t?Pt({},t.ALLOWED_ATTR):rt,wt="ADD_URI_SAFE_ATTR"in t?Pt(Bt(Tt),t.ADD_URI_SAFE_ATTR):Tt,vt="ADD_DATA_URI_TAGS"in t?Pt(Bt(bt),t.ADD_DATA_URI_TAGS):bt,O="FORBID_CONTENTS"in t?Pt({},t.FORBID_CONTENTS):yt,T="FORBID_TAGS"in t?Pt({},t.FORBID_TAGS):{},lt="FORBID_ATTR"in t?Pt({},t.FORBID_ATTR):{},_="USE_PROFILES"in t&&t.USE_PROFILES,ct=!1!==t.ALLOW_ARIA_ATTR,dt=!1!==t.ALLOW_DATA_ATTR,ht=t.ALLOW_UNKNOWN_PROTOCOLS||!1,C=t.SAFE_FOR_TEMPLATES||!1,S=t.WHOLE_DOCUMENT||!1,z=t.RETURN_DOM||!1,k=t.RETURN_DOM_FRAGMENT||!1,mt=!1!==t.RETURN_DOM_IMPORT,A=t.RETURN_TRUSTED_TYPE||!1,pt=t.FORCE_BODY||!1,gt=!1!==t.SANITIZE_DOM,ft=!1!==t.KEEP_CONTENT,x=t.IN_PLACE||!1,v=t.ALLOWED_URI_REGEXP||v,I=t.NAMESPACE||E,C&&(dt=!1),k&&(z=!0),_&&(b=Pt({},[].concat(Jt(Yt))),w=[],!0===_.html&&(Pt(b,Ut),Pt(w,Kt)),!0===_.svg&&(Pt(b,qt),Pt(w,Gt),Pt(w,Xt)),!0===_.svgFilters&&(Pt(b,Qt),Pt(w,Gt),Pt(w,Xt)),!0===_.mathMl&&(Pt(b,Vt),Pt(w,Zt),Pt(w,Xt))),t.ADD_TAGS&&Pt(b=b===at?Bt(b):b,t.ADD_TAGS),t.ADD_ATTR&&Pt(w=w===rt?Bt(w):w,t.ADD_ATTR),t.ADD_URI_SAFE_ATTR&&Pt(wt,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&Pt(O=O===yt?Bt(O):O,t.FORBID_CONTENTS),ft&&(b["#text"]=!0),S&&Pt(b,["html","head","body"]),b.table&&(Pt(b,["tbody"]),delete T.tbody),It&&It(t),D=t)}function p(e){Lt(c.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){try{e.outerHTML=Q}catch(t){e.remove()}}}function Z(t){var e=void 0,n=void 0,o=(pt?t="<remove></remove>"+t:n=(o=Nt(t,/^[\r\n\t ]+/))&&o[0],h?h.createHTML(t):t);if(I===E)try{e=(new B).parseFromString(o,"text/html")}catch(t){}if(!e||!e.documentElement){e=s.createDocument(I,"template",null);try{e.documentElement.innerHTML=et?"":o}catch(t){}}return o=e.body||e.documentElement,t&&n&&o.insertBefore(i.createTextNode(n),o.childNodes[0]||null),I===E?K.call(e,S?"html":"body")[0]:S?e.documentElement:o}function X(t){return V.call(t.ownerDocument||t,t,e.SHOW_ELEMENT|e.SHOW_COMMENT|e.SHOW_TEXT,null,!1)}function m(t){return"object"===(void 0===d?"undefined":$t(d))?t instanceof d:t&&"object"===(void 0===t?"undefined":$t(t))&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName}function $(t){var e;if(L("beforeSanitizeElements",t,null),!((n=t)instanceof H||n instanceof P||"string"==typeof n.nodeName&&"string"==typeof n.textContent&&"function"==typeof n.removeChild&&n.attributes instanceof F&&"function"==typeof n.removeAttribute&&"function"==typeof n.setAttribute&&"string"==typeof n.namespaceURI&&"function"==typeof n.insertBefore))return p(t),1;if(Nt(t.nodeName,/[\u0080-\uFFFF]/))return p(t),1;var n=Mt(t.nodeName);if(L("uponSanitizeElement",t,{tagName:n,allowedTags:b}),!m(t.firstElementChild)&&(!m(t.content)||!m(t.content.firstElementChild))&&Ht(/<[/\w]/g,t.innerHTML)&&Ht(/<[/\w]/g,t.textContent))return p(t),1;if("select"===n&&Ht(/<template/i,t.innerHTML))return p(t),1;if(b[n]&&!T[n])return(!(t instanceof j)||function(t){var e=a(t),n=(e&&e.tagName||(e={namespaceURI:E,tagName:"template"}),Mt(t.tagName)),o=Mt(e.tagName);if(t.namespaceURI===St)return e.namespaceURI===E?"svg"===n:e.namespaceURI===Ct?"svg"===n&&("annotation-xml"===o||kt[o]):Boolean(R[n]);if(t.namespaceURI===Ct)return e.namespaceURI===E?"math"===n:e.namespaceURI===St?"math"===n&&At[o]:Boolean(xt[n]);if(t.namespaceURI!==E)return!1;if(e.namespaceURI===St&&!At[o])return!1;if(e.namespaceURI===Ct&&!kt[o])return!1;t=Pt({},["title","style","font","a","script"]);return!xt[n]&&(t[n]||!R[n])}(t))&&("noscript"!==n&&"noembed"!==n||!Ht(/<\/no(script|embed)/i,t.innerHTML))?(C&&3===t.nodeType&&(e=t.textContent,e=jt(e,f," "),e=jt(e,y," "),t.textContent!==e&&(Lt(c.removed,{element:t.cloneNode()}),t.textContent=e)),L("afterSanitizeElements",t,null),!1):(p(t),!0);if(ft&&!O[n]){var o=a(t)||t.parentNode,i=q(t)||t.childNodes;if(i&&o)for(var s=i.length-1;0<=s;--s)o.insertBefore(W(i[s],!0),U(t))}return p(t),1}function J(t){var e=void 0,n=void 0,o=(L("beforeSanitizeAttributes",t,null),t.attributes);if(o){for(var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:w},n=o.length;n--;){r=o[n];var s=r.name,a=r.namespaceURI,e=te(r.value),r=Mt(s);if(i.attrName=r,i.attrValue=e,i.keepAttr=!0,i.forceKeepAttr=void 0,L("uponSanitizeAttribute",t,i),e=i.attrValue,!i.forceKeepAttr&&(_t(s,t),i.keepAttr))if(Ht(/\/>/i,e))_t(s,t);else{C&&(e=jt(e,f," "),e=jt(e,y," "));var l=t.nodeName.toLowerCase();if(Ot(l,r,e))try{a?t.setAttributeNS(a,s,e):t.setAttribute(s,e),Rt(c.removed)}catch(t){}}}L("afterSanitizeAttributes",t,null)}}function tt(t){var e,n=X(t);for(L("beforeSanitizeShadowDOM",t,null);e=n.nextNode();)L("uponSanitizeShadowNode",e,null),$(e)||(e.content instanceof N&&tt(e.content),J(e));L("afterSanitizeShadowDOM",t,null)}var et,g={},f=(c.isSupported="function"==typeof a&&s&&void 0!==s.createHTMLDocument&&9!==o,oe),y=ie,nt=se,ot=ae,it=le,st=ce,v=re,b=null,at=Pt({},[].concat(Jt(Ut),Jt(qt),Jt(Qt),Jt(Vt),Jt(Yt))),w=null,rt=Pt({},[].concat(Jt(Kt),Jt(Gt),Jt(Zt),Jt(Xt))),T=null,lt=null,ct=!0,dt=!0,ht=!1,C=!1,S=!1,ut=!1,pt=!1,z=!1,k=!1,mt=!0,A=!1,gt=!0,ft=!0,x=!1,_={},O=null,yt=Pt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),vt=null,bt=Pt({},["audio","video","img","source","image","track"]),wt=null,Tt=Pt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ct="http://www.w3.org/1998/Math/MathML",St="http://www.w3.org/2000/svg",E="http://www.w3.org/1999/xhtml",I=E,D=null,zt=i.createElement("form"),kt=Pt({},["mi","mo","mn","ms","mtext"]),At=Pt({},["foreignobject","desc","title","annotation-xml"]),R=Pt({},qt),xt=(Pt(R,Qt),Pt(R,ee),Pt({},Vt)),_t=(Pt(xt,ne),function(t,e){try{Lt(c.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){Lt(c.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!w[t])if(z||k)try{p(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}}),L=function(t,e,n){g[t]&&Dt(g[t],function(t){t.call(c,e,n,D)})},Ot=function(t,e,n){if(gt&&("id"===e||"name"===e)&&(n in i||n in zt))return!1;if((!dt||lt[e]||!Ht(nt,e))&&(!ct||!Ht(ot,e))){if(!w[e]||lt[e])return!1;if(!wt[e]&&!Ht(v,jt(n,st,""))&&("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==Ft(n,"data:")||!vt[t])&&(!ht||Ht(it,jt(n,st,"")))&&n)return!1}return!0};return c.sanitize=function(t,e){var n,o=void 0,i=void 0,s=void 0;if("string"!=typeof(t=(et=!t)?"\x3c!--\x3e":t)&&!m(t)){if("function"!=typeof t.toString)throw Et("toString is not a function");if("string"!=typeof(t=t.toString()))throw Et("dirty is not a string, aborting")}if(!c.isSupported){if("object"===$t(r.toStaticHTML)||"function"==typeof r.toStaticHTML){if("string"==typeof t)return r.toStaticHTML(t);if(m(t))return r.toStaticHTML(t.outerHTML)}return t}if(ut||u(e),c.removed=[],!(x="string"==typeof t?!1:x))if(t instanceof d)1===(e=(o=Z("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===e.nodeName||"HTML"===e.nodeName?o=e:o.appendChild(e);else{if(!z&&!C&&!S&&-1===t.indexOf("<"))return h&&A?h.createHTML(t):t;if(!(o=Z(t)))return z?null:Q}o&&pt&&p(o.firstChild);for(var a=X(x?t:o);n=a.nextNode();)3===n.nodeType&&n===i||$(n)||(n.content instanceof N&&tt(n.content),J(n),i=n);if(i=null,x)return t;if(z){if(k)for(s=Y.call(o.ownerDocument);o.firstChild;)s.appendChild(o.firstChild);else s=o;return s=mt?G.call(l,s,!0):s}e=S?o.outerHTML:o.innerHTML;return C&&(e=jt(e,f," "),e=jt(e,y," ")),h&&A?h.createHTML(e):e},c.setConfig=function(t){u(t),ut=!0},c.clearConfig=function(){D=null,ut=!1},c.isValidAttribute=function(t,e,n){D||u({});t=Mt(t),e=Mt(e);return Ot(t,e,n)},c.addHook=function(t,e){"function"==typeof e&&(g[t]=g[t]||[],Lt(g[t],e))},c.removeHook=function(t){g[t]&&Rt(g[t])},c.removeHooks=function(t){g[t]&&(g[t]=[])},c.removeAllHooks=function(){g={}},c}()});var bind=function(t,e){return function(){return t.apply(e,arguments)}},slice=[].slice,extend=function(t,e){for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);function o(){this.constructor=t}return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;!function(u,p){var e,n,o,i,s,t;function a(t){this.options=u.extend({},this.defaults,t),this.log=new n({debug:this.options.debug,logPrefix:this.options.logPrefix||this.logPrefix})}function r(t){this.log=bind(this.log,this),this.error=bind(this.error,this),this.notice=bind(this.notice,this),this.debug=bind(this.debug,this),this.options=u.extend({},this.defaults,t)}function l(t){this.stop=bind(this.stop,this),this.start=bind(this.start,this),l.__super__.constructor.call(this,t)}function c(t){this.ping=bind(this.ping,this),this.send=bind(this.send,this),this.reconnect=bind(this.reconnect,this),this.close=bind(this.close,this),this.connect=bind(this.connect,this),this.set=bind(this.set,this),c.__super__.constructor.call(this,t)}function d(t){if(this.removeAttributes=bind(this.removeAttributes,this),this.startTimeoutObservers=bind(this.startTimeoutObservers,this),this.onCssLoaded=bind(this.onCssLoaded,this),this.setAgentOnlineState=bind(this.setAgentOnlineState,this),this.onConnectionEstablished=bind(this.onConnectionEstablished,this),this.setSessionId=bind(this.setSessionId,this),this.onConnectionReestablished=bind(this.onConnectionReestablished,this),this.reconnect=bind(this.reconnect,this),this.destroy=bind(this.destroy,this),this.onScrollHintClick=bind(this.onScrollHintClick,this),this.detectScrolledtoBottom=bind(this.detectScrolledtoBottom,this),this.onLeaveTemporary=bind(this.onLeaveTemporary,this),this.onAgentTypingEnd=bind(this.onAgentTypingEnd,this),this.onAgentTypingStart=bind(this.onAgentTypingStart,this),this.onQueue=bind(this.onQueue,this),this.onQueueScreen=bind(this.onQueueScreen,this),this.onWebSocketClose=bind(this.onWebSocketClose,this),this.onCloseAnimationEnd=bind(this.onCloseAnimationEnd,this),this.close=bind(this.close,this),this.toggle=bind(this.toggle,this),this.sessionClose=bind(this.sessionClose,this),this.onOpenAnimationEnd=bind(this.onOpenAnimationEnd,this),this.open=bind(this.open,this),this.renderMessage=bind(this.renderMessage,this),this.receiveMessage=bind(this.receiveMessage,this),this.onSubmit=bind(this.onSubmit,this),this.onFocus=bind(this.onFocus,this),this.onInput=bind(this.onInput,this),this.onReopenSession=bind(this.onReopenSession,this),this.onError=bind(this.onError,this),this.onWebSocketMessage=bind(this.onWebSocketMessage,this),this.send=bind(this.send,this),this.checkForEnter=bind(this.checkForEnter,this),this.render=bind(this.render,this),this.view=bind(this.view,this),this.T=bind(this.T,this),this.options=u.extend({},this.defaults,t),d.__super__.constructor.call(this,this.options),this.isFullscreen=p.matchMedia&&p.matchMedia("(max-width: 768px)").matches,this.scrollRoot=u(this.getScrollRoot()),u)return p.WebSocket&&sessionStorage?this.options.chatId?(this.options.lang||(this.options.lang=u("html").attr("lang")),this.options.lang&&(this.translations[this.options.lang]||(this.log.debug("lang: No "+this.options.lang+" found, try first two letters"),this.options.lang=this.options.lang.replace(/-.+?$/,"")),this.log.debug("lang: "+this.options.lang)),this.options.host||this.detectHost(),this.loadCss(),this.io=new e(this.options),this.io.set({onOpen:this.render,onClose:this.onWebSocketClose,onMessage:this.onWebSocketMessage,onError:this.onError}),void this.io.connect()):(this.state="unsupported",void this.log.error("Chat: need chatId as option!")):(this.state="unsupported",void this.log.notice("Chat: Browser not supported!"));this.state="unsupported",this.log.notice("Chat: no jquery found!")}t=(t=document.getElementsByTagName("script"))[t.length-1],s=p.location.protocol.replace(":",""),t&&t.src&&(i=t.src.match(".*://([^:/]*).*")[1],s=t.src.match("(.*)://[^:/]*.*")[1]),a.prototype.defaults={debug:!1},t=a,r.prototype.defaults={debug:!1},r.prototype.debug=function(){var t=1<=arguments.length?slice.call(arguments,0):[];if(this.options.debug)return this.log("debug",t)},r.prototype.notice=function(){var t=1<=arguments.length?slice.call(arguments,0):[];return this.log("notice",t)},r.prototype.error=function(){var t=1<=arguments.length?slice.call(arguments,0):[];return this.log("error",t)},r.prototype.log=function(t,e){var n,o,i,s;if(e.unshift("||"),e.unshift(t),e.unshift(this.options.logPrefix),console.log.apply(console,e),this.options.debug){for(s="",o=0,i=e.length;o<i;o++)s+=" ","object"==typeof(n=e[o])?s+=JSON.stringify(n):n&&n.toString?s+=n.toString():s+=n;return u(".js-chatLogDisplay").prepend("<div>"+s+"</div>")}},n=r,extend(l,t),l.prototype.timeoutStartedAt=null,l.prototype.logPrefix="timeout",l.prototype.defaults={debug:!1,timeout:4,timeoutIntervallCheck:.5},l.prototype.start=function(){var t,e,n;return this.stop(),e=new Date,t=function(){var t=new Date-new Date(e.getTime()+1e3*n.options.timeout*60);if(n.log.debug("Timeout check for "+n.options.timeout+" minutes (left "+t/1e3+" sec.)"),!(t<0))return n.stop(),n.options.callback()},(n=this).log.debug("Start timeout in "+this.options.timeout+" minutes"),this.intervallId=setInterval(t,1e3*this.options.timeoutIntervallCheck*60)},l.prototype.stop=function(){if(this.intervallId)return this.log.debug("Stop timeout of "+this.options.timeout+" minutes"),clearInterval(this.intervallId)},o=l,extend(c,t),c.prototype.logPrefix="io",c.prototype.set=function(t){var e,n,o=[];for(e in t)n=t[e],o.push(this.options[e]=n);return o},c.prototype.connect=function(){var e,i,n,o;return this.log.debug("Connecting to "+this.options.host),this.ws=new p.WebSocket(""+this.options.host),this.ws.onopen=(e=this,function(t){return e.log.debug("onOpen",t),e.options.onOpen(t),e.ping()}),this.ws.onmessage=(i=this,function(t){var e,n,o=JSON.parse(t.data);for(i.log.debug("onMessage",t.data),e=0,n=o.length;e<n;e++)"pong"===o[e].event&&i.ping();if(i.options.onMessage)return i.options.onMessage(o)}),this.ws.onclose=(n=this,function(t){if(n.log.debug("close websocket connection",t),n.pingDelayId&&clearTimeout(n.pingDelayId),n.manualClose){if(n.log.debug("manual close, onClose callback"),n.manualClose=!1,n.options.onClose)return n.options.onClose(t)}else if(n.log.debug("error close, onError callback"),n.options.onError)return n.options.onError("Connection lost...")}),this.ws.onerror=(o=this,function(t){if(o.log.debug("onError",t),o.options.onError)return o.options.onError(t)})},c.prototype.close=function(){return this.log.debug("close websocket manually"),this.manualClose=!0,this.ws.close()},c.prototype.reconnect=function(){return this.log.debug("reconnect"),this.close(),this.connect()},c.prototype.send=function(t,e){return this.log.debug("send",t,e=null==e?{}:e),t=JSON.stringify({event:t,data:e}),this.ws.send(t)},c.prototype.ping=function(){var t;return(t=this).pingDelayId=setTimeout(function(){return t.send("ping")},29e3)},e=c,extend(d,t),d.prototype.defaults={chatId:void 0,show:!0,target:u("body"),host:"",debug:!1,flat:!1,lang:void 0,cssAutoload:!0,cssUrl:void 0,fontSize:void 0,buttonClass:"open-zammad-chat",inactiveClass:"is-inactive",title:"<strong>Chat</strong> with us!",scrollHint:"Scroll down to see new messages",idleTimeout:6,idleTimeoutIntervallCheck:.5,inactiveTimeout:8,inactiveTimeoutIntervallCheck:.5,waitingListTimeout:4,waitingListTimeoutIntervallCheck:.5,onReady:void 0,onCloseAnimationEnd:void 0,onError:void 0,onOpenAnimationEnd:void 0,onConnectionReestablished:void 0,onSessionClosed:void 0,onConnectionEstablished:void 0,onCssLoaded:void 0},d.prototype.logPrefix="chat",d.prototype._messageCount=0,d.prototype.isOpen=!1,d.prototype.blinkOnlineInterval=null,d.prototype.stopBlinOnlineStateTimeout=null,d.prototype.showTimeEveryXMinutes=2,d.prototype.lastTimestamp=null,d.prototype.lastAddedType=null,d.prototype.inputDisabled=!1,d.prototype.inputTimeout=null,d.prototype.isTyping=!1,d.prototype.state="offline",d.prototype.initialQueueDelay=1e4,d.prototype.translations={de:{"<strong>Chat</strong> with us!":"<strong>Chatte</strong> mit uns!","All colleagues are busy.":"Alle Kollegen sind beschäftigt.","Chat closed by %s":"Chat von %s geschlossen","Compose your message…":"Verfassen Sie Ihre Nachricht…",Connecting:"Verbinde","Connection lost":"Verbindung verloren","Connection re-established":"Verbindung wieder aufgebaut",Offline:"Offline",Online:"Online","Scroll down to see new messages":"Nach unten scrollen um neue Nachrichten zu sehen",Send:"Senden","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Neue Unterhaltung starten",Today:"Heute","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Sie sind in der Warteliste auf Position <strong>%s</strong>."},es:{"<strong>Chat</strong> with us!":"<strong>Chatee</strong> con nosotros!","All colleagues are busy.":"Todos los colegas están ocupados.","Chat closed by %s":"Chat cerrado por %s","Compose your message…":"Escribe tu mensaje…",Connecting:"Conectando","Connection lost":"Conexión perdida","Connection re-established":"Conexión reestablecida",Offline:"Desconectado",Online:"En línea","Scroll down to see new messages":"Haga scroll hacia abajo para ver nuevos mensajes",Send:"Enviar","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Iniciar nueva conversación",Today:"Hoy","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Usted está en la posición <strong>%s</strong> de la lista de espera."},fr:{"<strong>Chat</strong> with us!":"<strong>Chattez</strong> avec nous!","All colleagues are busy.":"Tout les agents sont occupés.","Chat closed by %s":"Chat fermé par %s","Compose your message…":"Ecrivez votre message…",Connecting:"Connexion","Connection lost":"Connexion perdue","Connection re-established":"Connexion ré-établie",Offline:"Hors-ligne",Online:"En ligne","Scroll down to see new messages":"Défiler vers le bas pour voir les nouveaux messages",Send:"Envoyer","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Démarrer une nouvelle conversation",Today:"Aujourd'hui","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Vous êtes actuellement en position <strong>%s</strong> dans la file d'attente."},it:{"<strong>Chat</strong> with us!":"<strong>Chatta</strong> con noi!","All colleagues are busy.":"Tutti i colleghi sono occupati.","Chat closed by %s":"Chat chiusa da %s","Compose your message…":"Scrivi il tuo messaggio…",Connecting:"Connessione in corso","Connection lost":"Connessione persa","Connection re-established":"Connessione ristabilita",Offline:"Offline",Online:"Online","Scroll down to see new messages":"Scorri verso il basso per vedere i nuovi messaggi",Send:"Invia","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Avvia una nuova chat",Today:"Oggi","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Sei alla posizione <strong>%s</strong> della lista di attesa."},nl:{"<strong>Chat</strong> with us!":"<strong>Chat</strong> met ons!","All colleagues are busy.":"Alle collega's zijn bezet.","Chat closed by %s":"Chat gesloten door %s","Compose your message…":"Stel je bericht op…",Connecting:"Verbinden","Connection lost":"Verbinding verbroken","Connection re-established":"Verbinding hersteld",Offline:"Offline",Online:"Online","Scroll down to see new messages":"Scroll naar beneden om nieuwe tickets te bekijken",Send:"Verstuur","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Nieuw gesprek starten",Today:"Vandaag","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"U bevindt zich op wachtlijstpositie <strong>%s</strong>."},pl:{"<strong>Chat</strong> with us!":"<strong>Czatuj</strong> z nami!","All colleagues are busy.":"Wszyscy agenci są zajęci.","Chat closed by %s":"Chat zamknięty przez %s","Compose your message…":"Skomponuj swoją wiadomość…",Connecting:"Łączenie","Connection lost":"Utracono połączenie","Connection re-established":"Ponowne nawiązanie połączenia",Offline:"Offline",Online:"Online","Scroll down to see new messages":"Skroluj w dół, aby zobaczyć wiadomości",Send:"Wyślij","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Rozpocznij nową rozmowę",Today:"Dzisiaj","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Jesteś na pozycji listy oczekujących <strong>%s</strong>."},"pt-br":{"<strong>Chat</strong> with us!":"<strong>Converse</strong> conosco!","All colleagues are busy.":"Nossos atendentes estão ocupados.","Chat closed by %s":"Chat encerrado por %s","Compose your message…":"Escreva sua mensagem…",Connecting:"Conectando","Connection lost":"Conexão perdida","Connection re-established":"Conexão restabelecida",Offline:"Desconectado",Online:"Online","Scroll down to see new messages":"Rolar para baixo para ver novas mensagems",Send:"Enviar","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Iniciar uma nova conversa",Today:"Hoje","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Você está na posição <strong>%s</strong> da lista de espera."},ru:{"<strong>Chat</strong> with us!":"<strong>Напишите</strong> нам!","All colleagues are busy.":"Все коллеги заняты.","Chat closed by %s":"Чат закрыт %s","Compose your message…":"Составьте сообщение…",Connecting:"Подключение","Connection lost":"Подключение потеряно","Connection re-established":"Подключение восстановлено",Offline:"Оффлайн",Online:"В сети","Scroll down to see new messages":"Прокрутите вниз, чтобы увидеть новые сообщения",Send:"Отправить","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Начать новую беседу",Today:"Сегодня","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Вы находитесь в списке ожидания <strong>%s</strong>."},sr:{"<strong>Chat</strong> with us!":"<strong>Ћаскајте</strong> са нама!","All colleagues are busy.":"Све колеге су заузете.","Chat closed by %s":"Ћаскање затворено од стране %s","Compose your message…":"Напишите поруку…",Connecting:"Повезивање","Connection lost":"Веза је изгубљена","Connection re-established":"Веза је поново успостављена",Offline:"Одсутан(а)",Online:"Доступан(а)","Scroll down to see new messages":"Скролујте на доле за нове поруке",Send:"Пошаљи","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Започни нови разговор",Today:"Данас","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Ви сте тренутно <strong>%s.</strong> у реду за чекање."},"sr-latn-rs":{"<strong>Chat</strong> with us!":"<strong>Ćaskajte</strong> sa nama!","All colleagues are busy.":"Sve kolege su zauzete.","Chat closed by %s":"Ćaskanje zatvoreno od strane %s","Compose your message…":"Napišite poruku…",Connecting:"Povezivanje","Connection lost":"Veza je izgubljena","Connection re-established":"Veza je ponovo uspostavljena",Offline:"Odsutan(a)",Online:"Dostupan(a)","Scroll down to see new messages":"Skrolujte na dole za nove poruke",Send:"Pošalji","Since you didn't respond in the last %s minutes your conversation was closed.":"","Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.":"","Start new conversation":"Započni novi razgovor",Today:"Danas","We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!":"","You are on waiting list position <strong>%s</strong>.":"Vi ste trenutno <strong>%s.</strong> u redu za čekanje."}},d.prototype.sessionId=void 0,d.prototype.scrolledToBottom=!0,d.prototype.scrollSnapTolerance=10,d.prototype.richTextFormatKey={66:!0,73:!0,85:!0,83:!0},d.prototype.T=function(){var t,e,n,o,i=arguments[0],s=2<=arguments.length?slice.call(arguments,1):[];if(this.options.lang&&"en"!==this.options.lang&&(this.translations[this.options.lang]?((o=this.translations[this.options.lang])[i]||this.log.notice("Translation needed for '"+i+"'"),i=o[i]||i):this.log.notice("Translation '"+this.options.lang+"' needed!")),s)for(e=0,n=s.length;e<n;e++)t=s[e],i=i.replace(/%s/,t);return i},d.prototype.view=function(e){return n=this,function(t){return(t=t||{}).T=n.T,t.background=n.options.background,t.flat=n.options.flat,t.fontSize=n.options.fontSize,p.zammadChatTemplates[e](t)};var n},d.prototype.getScrollRoot=function(){var t,e,n;return"scrollingElement"in document?document.scrollingElement:(n=(e=document.documentElement).scrollTop,e.scrollTop=n+1,t=e.scrollTop,(e.scrollTop=n)<t?e:document.body)},d.prototype.render=function(){return this.el&&u(".zammad-chat").get(0)||this.renderBase(),u("."+this.options.buttonClass).addClass(this.options.inactiveClass),this.setAgentOnlineState("online"),this.log.debug("widget rendered"),this.startTimeoutObservers(),this.idleTimeout.start(),this.sessionId=sessionStorage.getItem("sessionId"),this.send("chat_status_customer",{session_id:this.sessionId,url:p.location.href})},d.prototype.renderBase=function(){var n,a,l,t,e;if(this.el=u(this.view("chat")({title:this.options.title,scrollHint:this.options.scrollHint})),this.options.target.append(this.el),this.input=this.el.find(".zammad-chat-input"),this.el.find(".js-chat-open").on("click",this.open),this.el.find(".js-chat-toggle").on("click",this.toggle),this.el.find(".js-chat-status").on("click",this.stopPropagation),this.el.find(".zammad-chat-controls").on("submit",this.onSubmit),this.el.find(".zammad-chat-body").on("scroll",this.detectScrolledtoBottom),this.el.find(".zammad-scroll-hint").on("click",this.onScrollHintClick),this.input.on({keydown:this.checkForEnter,input:this.onInput}),this.input.on("keydown",(n=this,function(t){var e=!1;if((e=(t.altKey||t.ctrlKey||!t.metaKey)&&(t.altKey||!t.ctrlKey||t.metaKey)?e:!0)&&n.richTextFormatKey[t.keyCode])return t.preventDefault(),66===t.keyCode?(document.execCommand("bold"),!0):73===t.keyCode?(document.execCommand("italic"),!0):85===t.keyCode?(document.execCommand("underline"),!0):83===t.keyCode?(document.execCommand("strikeThrough"),!0):void 0})),this.input.on("paste",(a=this,function(e){var n,o,i,t,s;if(e.stopPropagation(),e.preventDefault(),e.clipboardData)o=e.clipboardData;else if(p.clipboardData)o=p.clipboardData;else{if(!e.originalEvent.clipboardData)throw"No clipboardData support";o=e.originalEvent.clipboardData}if(t=!1,o&&o.items&&o.items[0]&&("file"!==(n=o.items[0]).kind||"image/png"!==n.type&&"image/jpeg"!==n.type||(n=n.getAsFile(),(s=new FileReader).onload=function(t){var t=t.target.result,i=document.createElement("img");return i.src=t,a.resizeImage(i.src,460,"auto",2,"image/jpeg","auto",function(t,e,n,o){return a.isRetina()&&(e/=2,0),i='<img style="width: 100%; max-width: '+e+'px;" src="'+t+'">',document.execCommand("insertHTML",!1,i)})},s.readAsDataURL(n),t=!0)),!t){n=s=void 0;try{s=o.getData("text/html"),n="html",s&&0!==s.length||(n="text",s=o.getData("text/plain")),s&&0!==s.length||(n="text2",s=o.getData("text"))}catch(t){e=t,console.log("Sorry, can't insert markup because browser is not supporting it."),n="text3",s=o.getData("text")}return"text"!==n&&"text2"!==n&&"text3"!==n||(s=(s="<div>"+s.replace(/\n/g,"</div><div>")+"</div>").replace(/<div><\/div>/g,"<div><br></div>")),console.log("p",n,s),"html"===n&&(t=DOMPurify.sanitize(s),a.log.debug("sanitized HTML clipboard",t),e=u("<div>"+t+"</div>"),o=!1,t=s,i=new RegExp("<(/w|w):[A-Za-z]"),t.match(i)&&(o=!0,t=t.replace(i,"")),i=new RegExp("<(/o|o):[A-Za-z]"),t.match(i)&&(o=!0,t=t.replace(i,"")),o&&(e=a.wordFilter(e)),(e=u(e)).contents().each(function(){if(8===this.nodeType)return u(this).remove()}),e.find("a, font, small, time, form, label").replaceWith(function(){return u(this).contents()}),e.find("textarea").each(function(){var t=this.outerHTML;return i=new RegExp("<"+this.tagName,"i"),t=t.replace(i,"<div"),i=new RegExp("</"+this.tagName,"i"),t=t.replace(i,"</div"),u(this).replaceWith(t)}),e.find("font, img, svg, input, select, button, style, applet, embed, noframes, canvas, script, frame, iframe, meta, link, title, head, fieldset").remove(),a.removeAttributes(e),s=e.html()),"text3"===n?a.pasteHtmlAtCaret(s):document.execCommand("insertHTML",!1,s),!0}})),this.input.on("drop",(l=this,function(t){var e,a,r;if(t.stopPropagation(),t.preventDefault(),p.dataTransfer)e=p.dataTransfer;else{if(!t.originalEvent.dataTransfer)throw"No clipboardData support";e=t.originalEvent.dataTransfer}if(a=t.clientX,r=t.clientY,(t=e.files[0]).type.match("image.*"))return(e=new FileReader).onload=function(t){var t=t.target.result,s=document.createElement("img");return s.src=t,l.resizeImage(s.src,460,"auto",2,"image/jpeg","auto",function(t,e,n,o){var i;return l.isRetina()&&(e/=2,0),s=(s=u('<img style="width: 100%; max-width: '+e+'px;" src="'+t+'">')).get(0),document.caretPositionFromPoint?(e=document.caretPositionFromPoint(a,r),(i=document.createRange()).setStart(e.offsetNode,e.offset),i.collapse(),i.insertNode(s)):document.caretRangeFromPoint?(i=document.caretRangeFromPoint(a,r)).insertNode(s):console.log("could not find carat")})},e.readAsDataURL(t)})),u(p).on("beforeunload",(t=this,function(){return t.onLeaveTemporary()})),u(p).on("hashchange",(e=this,function(){if(!e.isOpen)return e.idleTimeout.start();e.sessionId&&e.send("chat_session_notice",{session_id:e.sessionId,message:p.location.href})})),this.isFullscreen)return this.input.on({focus:this.onFocus,focusout:this.onFocusOut})},d.prototype.stopPropagation=function(t){return t.stopPropagation()},d.prototype.checkForEnter=function(t){if(!this.inputDisabled&&!t.shiftKey&&13===t.keyCode)return t.preventDefault(),this.sendMessage()},d.prototype.send=function(t,e){return(e=null==e?{}:e).chat_id=this.options.chatId,this.io.send(t,e)},d.prototype.onWebSocketMessage=function(t){for(var e,n=0,o=t.length;n<o;n++)switch(e=t[n],this.log.debug("ws:onmessage",e),e.event){case"chat_error":this.log.notice(e.data),e.data&&"chat_disabled"===e.data.state&&this.destroy({remove:!0});break;case"chat_session_message":if(e.data.self_written)return;this.receiveMessage(e.data);break;case"chat_session_typing":if(e.data.self_written)return;this.onAgentTypingStart();break;case"chat_session_start":this.onConnectionEstablished(e.data);break;case"chat_session_queue":this.onQueueScreen(e.data);break;case"chat_session_closed":case"chat_session_left":this.onSessionClosed(e.data);break;case"chat_session_notice":this.addStatus(this.T(e.data.message));break;case"chat_status_customer":switch(e.data.state){case"online":this.sessionId=void 0,!this.options.cssAutoload||this.cssLoaded?this.onReady():this.socketReady=!0;break;case"offline":this.onError("Zammad Chat: No agent online");break;case"chat_disabled":this.onError("Zammad Chat: Chat is disabled");break;case"no_seats_available":this.onError("Zammad Chat: Too many clients in queue. Clients in queue: "+e.data.queue);break;case"reconnect":this.onReopenSession(e.data)}}},d.prototype.onReady=function(){var t;if(this.log.debug("widget ready for use"),u("."+this.options.buttonClass).on("click",this.open).removeClass(this.options.inactiveClass),"function"==typeof(t=this.options).onReady&&t.onReady(),this.options.show)return this.show()},d.prototype.onError=function(t){var e;return this.log.debug(t),this.addStatus(t),u("."+this.options.buttonClass).hide(),this.isOpen?(this.disableInput(),this.destroy({remove:!1})):this.destroy({remove:!0}),"function"==typeof(e=this.options).onError?e.onError(t):void 0},d.prototype.onReopenSession=function(t){var e,n,o,i,s;if(this.log.debug("old messages",t.session),this.inactiveTimeout.start(),s=sessionStorage.getItem("unfinished_message"),t.agent){for(this.onConnectionEstablished(t),e=0,n=(i=t.session).length;e<n;e++)o=i[e],this.renderMessage({message:o.content,id:o.id,from:o.created_by_id?"agent":"customer"});s&&this.input.html(s)}if(t.position&&this.onQueue(t),this.show(),this.open(),this.scrollToBottom(),s)return this.input.trigger("focus")},d.prototype.onInput=function(){return this.el.find(".zammad-chat-message--unread").removeClass("zammad-chat-message--unread"),sessionStorage.setItem("unfinished_message",this.input.html()),this.onTyping()},d.prototype.onFocus=function(){var t;if(u(p).scrollTop(10),t=0<u(p).scrollTop(),u(p).scrollTop(0),t)return this.log.notice("virtual keyboard shown")},d.prototype.onFocusOut=function(){},d.prototype.onTyping=function(){if(!(this.isTyping&&this.isTyping>new Date((new Date).getTime()-1500)))return this.isTyping=new Date,this.send("chat_session_typing",{session_id:this.sessionId}),this.inactiveTimeout.start()},d.prototype.onSubmit=function(t){return t.preventDefault(),this.sendMessage()},d.prototype.sendMessage=function(){var t,e=this.input.html();if(e)return this.inactiveTimeout.start(),sessionStorage.removeItem("unfinished_message"),t=this.view("message")({message:e,from:"customer",id:this._messageCount++,unreadClass:""}),this.maybeAddTimestamp(),this.el.find(".zammad-chat-message--typing").get(0)?(this.lastAddedType="typing-placeholder",this.el.find(".zammad-chat-message--typing").before(t)):(this.lastAddedType="message--customer",this.el.find(".zammad-chat-body").append(t)),this.input.html(""),this.scrollToBottom(),this.send("chat_session_message",{content:e,id:this._messageCount,session_id:this.sessionId})},d.prototype.receiveMessage=function(t){return this.inactiveTimeout.start(),this.onAgentTypingEnd(),this.maybeAddTimestamp(),this.renderMessage({message:t.message.content,id:t.id,from:"agent"}),this.scrollToBottom({showHint:!0})},d.prototype.renderMessage=function(t){return this.lastAddedType="message--"+t.from,t.unreadClass=document.hidden?" zammad-chat-message--unread":"",this.el.find(".zammad-chat-body").append(this.view("message")(t))},d.prototype.open=function(){var t;if(!this.isOpen)return this.isOpen=!0,this.log.debug("open widget"),this.show(),this.sessionId||this.showLoader(),this.el.addClass("zammad-chat-is-open"),t=this.el.height()-this.el.find(".zammad-chat-header").outerHeight(),this.el.css("bottom",-t),this.sessionId?(this.el.css("bottom",0),this.onOpenAnimationEnd()):(this.el.animate({bottom:0},500,this.onOpenAnimationEnd),this.send("chat_session_init",{url:p.location.href}));this.log.debug("widget already open, block")},d.prototype.onOpenAnimationEnd=function(){var t;return this.idleTimeout.stop(),this.isFullscreen&&this.disableScrollOnRoot(),"function"==typeof(t=this.options).onOpenAnimationEnd?t.onOpenAnimationEnd():void 0},d.prototype.sessionClose=function(){return this.send("chat_session_close",{session_id:this.sessionId}),this.inactiveTimeout.stop(),this.waitingListTimeout.stop(),sessionStorage.removeItem("unfinished_message"),this.onInitialQueueDelayId&&clearTimeout(this.onInitialQueueDelayId),this.setSessionId(void 0)},d.prototype.toggle=function(t){return this.isOpen?this.close(t):this.open(t)},d.prototype.close=function(t){if(this.isOpen)return this.initDelayId&&clearTimeout(this.initDelayId),this.sessionId&&(this.log.debug("session close before widget close"),this.sessionClose()),this.log.debug("close widget"),t&&t.stopPropagation(),this.isFullscreen&&this.enableScrollOnRoot(),t=this.el.height()-this.el.find(".zammad-chat-header").outerHeight(),this.el.animate({bottom:-t},500,this.onCloseAnimationEnd);this.log.debug("can't close widget, it's not open")},d.prototype.onCloseAnimationEnd=function(){var t;return this.el.css("bottom",""),this.el.removeClass("zammad-chat-is-open"),this.showLoader(),this.el.find(".zammad-chat-welcome").removeClass("zammad-chat-is-hidden"),this.el.find(".zammad-chat-agent").addClass("zammad-chat-is-hidden"),this.el.find(".zammad-chat-agent-status").addClass("zammad-chat-is-hidden"),this.isOpen=!1,"function"==typeof(t=this.options).onCloseAnimationEnd&&t.onCloseAnimationEnd(),this.io.reconnect()},d.prototype.onWebSocketClose=function(){if(!this.isOpen)return this.el?(this.el.removeClass("zammad-chat-is-shown"),this.el.removeClass("zammad-chat-is-loaded")):void 0},d.prototype.show=function(){if("offline"!==this.state)return this.el.addClass("zammad-chat-is-loaded"),this.el.addClass("zammad-chat-is-shown")},d.prototype.disableInput=function(){return this.inputDisabled=!0,this.input.prop("contenteditable",!1),this.el.find(".zammad-chat-send").prop("disabled",!0),this.io.close()},d.prototype.enableInput=function(){return this.inputDisabled=!1,this.input.prop("contenteditable",!0),this.el.find(".zammad-chat-send").prop("disabled",!1)},d.prototype.hideModal=function(){return this.el.find(".zammad-chat-modal").html("")},d.prototype.onQueueScreen=function(t){var e,n;if(this.setSessionId(t.session_id),e=function(){return n.onQueue(t),n.waitingListTimeout.start()},!(n=this).initialQueueDelay||this.onInitialQueueDelayId)return this.onInitialQueueDelayId&&clearTimeout(this.onInitialQueueDelayId),e();this.onInitialQueueDelayId=setTimeout(e,this.initialQueueDelay)},d.prototype.onQueue=function(t){return this.log.notice("onQueue",t.position),this.inQueue=!0,this.el.find(".zammad-chat-modal").html(this.view("waiting")({position:t.position}))},d.prototype.onAgentTypingStart=function(){if(this.stopTypingId&&clearTimeout(this.stopTypingId),this.stopTypingId=setTimeout(this.onAgentTypingEnd,3e3),!this.el.find(".zammad-chat-message--typing").get(0)&&(this.maybeAddTimestamp(),this.el.find(".zammad-chat-body").append(this.view("typingIndicator")()),this.isVisible(this.el.find(".zammad-chat-message--typing"),!0)))return this.scrollToBottom()},d.prototype.onAgentTypingEnd=function(){return this.el.find(".zammad-chat-message--typing").remove()},d.prototype.onLeaveTemporary=function(){if(this.sessionId)return this.send("chat_session_leave_temporary",{session_id:this.sessionId})},d.prototype.maybeAddTimestamp=function(){var t,e,n=Date.now();if(!this.lastTimestamp||n-this.lastTimestamp>6e4*this.showTimeEveryXMinutes)return t=this.T("Today"),e=(new Date).toTimeString().substr(0,5),"timestamp"===this.lastAddedType?(this.updateLastTimestamp(t,e),this.lastTimestamp=n):(this.el.find(".zammad-chat-body").append(this.view("timestamp")({label:t,time:e})),this.lastTimestamp=n,this.lastAddedType="timestamp",this.scrollToBottom())},d.prototype.updateLastTimestamp=function(t,e){if(this.el)return this.el.find(".zammad-chat-body").find(".zammad-chat-timestamp").last().replaceWith(this.view("timestamp")({label:t,time:e}))},d.prototype.addStatus=function(t){if(this.el)return this.maybeAddTimestamp(),this.el.find(".zammad-chat-body").append(this.view("status")({status:t})),this.scrollToBottom()},d.prototype.detectScrolledtoBottom=function(){var t=this.el.find(".zammad-chat-body").scrollTop()+this.el.find(".zammad-chat-body").outerHeight();if(this.scrolledToBottom=Math.abs(t-this.el.find(".zammad-chat-body").prop("scrollHeight"))<=this.scrollSnapTolerance,this.scrolledToBottom)return this.el.find(".zammad-scroll-hint").addClass("is-hidden")},d.prototype.showScrollHint=function(){return this.el.find(".zammad-scroll-hint").removeClass("is-hidden"),this.el.find(".zammad-chat-body").scrollTop(this.el.find(".zammad-chat-body").scrollTop()+this.el.find(".zammad-scroll-hint").outerHeight())},d.prototype.onScrollHintClick=function(){return this.el.find(".zammad-chat-body").animate({scrollTop:this.el.find(".zammad-chat-body").prop("scrollHeight")},300)},d.prototype.scrollToBottom=function(t){t=(null!=t?t:{showHint:!1}).showHint;return this.scrolledToBottom?this.el.find(".zammad-chat-body").scrollTop(u(".zammad-chat-body").prop("scrollHeight")):t?this.showScrollHint():void 0},d.prototype.destroy=function(t){return this.log.debug("destroy widget",t=null==t?{}:t),this.setAgentOnlineState("offline"),t.remove&&this.el&&(this.el.remove(),u("."+this.options.buttonClass).hide()),this.waitingListTimeout&&this.waitingListTimeout.stop(),this.inactiveTimeout&&this.inactiveTimeout.stop(),this.idleTimeout&&this.idleTimeout.stop(),this.io.close()},d.prototype.reconnect=function(){return this.log.notice("reconnecting"),this.disableInput(),this.lastAddedType="status",this.setAgentOnlineState("connecting"),this.addStatus(this.T("Connection lost"))},d.prototype.onConnectionReestablished=function(){var t;return this.lastAddedType="status",this.setAgentOnlineState("online"),this.addStatus(this.T("Connection re-established")),"function"==typeof(t=this.options).onConnectionReestablished?t.onConnectionReestablished():void 0},d.prototype.onSessionClosed=function(t){var e;return this.addStatus(this.T("Chat closed by %s",t.realname)),this.disableInput(),this.setAgentOnlineState("offline"),this.inactiveTimeout.stop(),"function"==typeof(e=this.options).onSessionClosed?e.onSessionClosed(t):void 0},d.prototype.setSessionId=function(t){return void 0===(this.sessionId=t)?sessionStorage.removeItem("sessionId"):sessionStorage.setItem("sessionId",t)},d.prototype.onConnectionEstablished=function(t){var e;return this.onInitialQueueDelayId&&clearTimeout(this.onInitialQueueDelayId),this.inQueue=!1,t.agent&&(this.agent=t.agent),t.session_id&&this.setSessionId(t.session_id),this.el.find(".zammad-chat-body").html(""),this.el.find(".zammad-chat-agent").html(this.view("agent")({agent:this.agent})),this.enableInput(),this.hideModal(),this.el.find(".zammad-chat-welcome").addClass("zammad-chat-is-hidden"),this.el.find(".zammad-chat-agent").removeClass("zammad-chat-is-hidden"),this.el.find(".zammad-chat-agent-status").removeClass("zammad-chat-is-hidden"),this.isFullscreen||this.input.trigger("focus"),this.setAgentOnlineState("online"),this.waitingListTimeout.stop(),this.idleTimeout.stop(),this.inactiveTimeout.start(),"function"==typeof(e=this.options).onConnectionEstablished?e.onConnectionEstablished(t):void 0},d.prototype.showCustomerTimeout=function(){var t;return this.el.find(".zammad-chat-modal").html(this.view("customer_timeout")({agent:this.agent.name,delay:this.options.inactiveTimeout})),t=function(){return location.reload()},this.el.find(".js-restart").on("click",t),this.sessionClose()},d.prototype.showWaitingListTimeout=function(){var t;return this.el.find(".zammad-chat-modal").html(this.view("waiting_list_timeout")({delay:this.options.watingListTimeout})),t=function(){return location.reload()},this.el.find(".js-restart").on("click",t),this.sessionClose()},d.prototype.showLoader=function(){return this.el.find(".zammad-chat-modal").html(this.view("loader")())},d.prototype.setAgentOnlineState=function(t){var e;if(this.state=t,this.el)return e=t.charAt(0).toUpperCase()+t.slice(1),this.el.find(".zammad-chat-agent-status").attr("data-status",t).text(this.T(e))},d.prototype.detectHost=function(){var t="https"===s?"wss://":"ws://";return this.options.host=""+t+i+"/ws"},d.prototype.loadCss=function(){var t,e;if(this.options.cssAutoload)return(e=this.options.cssUrl)||(e=this.options.host.replace(/^wss/i,"https").replace(/^ws/i,"http").replace(/\/ws$/i,""),e+="/assets/chat/chat.css"),this.log.debug("load css from '"+e+"'"),e="@import url('"+e+"');",(t=document.createElement("link")).onload=this.onCssLoaded,t.rel="stylesheet",t.href="data:text/css,"+escape(e),document.getElementsByTagName("head")[0].appendChild(t)},d.prototype.onCssLoaded=function(){var t;return this.cssLoaded=!0,this.socketReady&&this.onReady(),"function"==typeof(t=this.options).onCssLoaded?t.onCssLoaded():void 0},d.prototype.startTimeoutObservers=function(){var t,e,n;return this.idleTimeout=new o({logPrefix:"idleTimeout",debug:this.options.debug,timeout:this.options.idleTimeout,timeoutIntervallCheck:this.options.idleTimeoutIntervallCheck,callback:(t=this,function(){return t.log.debug("Idle timeout reached, hide widget",new Date),t.destroy({remove:!0})})}),this.inactiveTimeout=new o({logPrefix:"inactiveTimeout",debug:this.options.debug,timeout:this.options.inactiveTimeout,timeoutIntervallCheck:this.options.inactiveTimeoutIntervallCheck,callback:(e=this,function(){return e.log.debug("Inactive timeout reached, show timeout screen.",new Date),e.showCustomerTimeout(),e.destroy({remove:!1})})}),this.waitingListTimeout=new o({logPrefix:"waitingListTimeout",debug:this.options.debug,timeout:this.options.waitingListTimeout,timeoutIntervallCheck:this.options.waitingListTimeoutIntervallCheck,callback:(n=this,function(){return n.log.debug("Waiting list timeout reached, show timeout screen.",new Date),n.showWaitingListTimeout(),n.destroy({remove:!1})})})},d.prototype.disableScrollOnRoot=function(){return this.rootScrollOffset=this.scrollRoot.scrollTop(),this.scrollRoot.css({overflow:"hidden",position:"fixed"})},d.prototype.enableScrollOnRoot=function(){return this.scrollRoot.scrollTop(this.rootScrollOffset),this.scrollRoot.css({overflow:"",position:""})},d.prototype.isVisible=function(t,e,n,o){var i,s,a,r,l,c,d,h;if(!(t.length<1))return i=u(p),a=(t=1<t.length?t.eq(0):t).get(0),h=i.width(),d=i.height(),o=o||"both",n=!0!==n||a.offsetWidth*a.offsetHeight,"function"==typeof a.getBoundingClientRect?(r=0<=(a=a.getBoundingClientRect()).top&&a.top<d,l=0<a.bottom&&a.bottom<=d,c=0<=a.left&&a.left<h,a=0<a.right&&a.right<=h,r=e?r||l:r&&l,l=e?c||a:c&&a,"both"===o?n&&r&&l:"vertical"===o?n&&r:"horizontal"===o?n&&l:void 0):(a=(c=i.scrollTop())+d,l=(r=i.scrollLeft())+h,h=(i=(d=t.offset()).top)+t.height(),t=(d=d.left)+t.width(),s=!0===e?h:i,i=!0===e?i:h,h=!0===e?t:d,e=!0===e?d:t,"both"===o?!!n&&i<=a&&c<=s&&e<=l&&r<=h:"vertical"===o?!!n&&i<=a&&c<=s:"horizontal"===o?!!n&&e<=l&&r<=h:void 0)},d.prototype.isRetina=function(){var t;return!!p.matchMedia&&((t=p.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)"))&&t.matches||1<p.devicePixelRatio)},d.prototype.resizeImage=function(t,o,i,s,a,r,l,e){var c;return null==o&&(o="auto"),null==i&&(i="auto"),null==s&&(s=1),null==e&&(e=!0),(c=new Image).onload=function(){var t,e=c.width,n=c.height;return console.log("ImageService","current size",e,n),"auto"===i&&"auto"===o&&(o=e,i=n),"auto"===i&&(i=n/(e/o)),t=!1,(o="auto"===o?n/(e/i):o)<e||i<n?(t=!0,o*=s,i*=s):(o=e,i=n),(e=document.createElement("canvas")).width=o,e.height=i,e.getContext("2d").drawImage(c,0,0,o,i),"auto"===r&&(r=o<200&&i<200?1:o<400&&i<400?.9:o<600&&i<600?.8:o<900&&i<900?.7:.6),n=e.toDataURL(a,r),t?(console.log("ImageService","resize",o/s,i/s,r,.75*n.length/1024/1024,"in mb"),void l(n,o/s,i/s,!0)):(console.log("ImageService","no resize",o,i,r,.75*n.length/1024/1024,"in mb"),l(n,o,i,!1))},c.src=t},d.prototype.pasteHtmlAtCaret=function(t){var e,n,o,i,s=void 0,a=void 0;if(p.getSelection){if((s=p.getSelection()).getRangeAt&&s.rangeCount){for((a=s.getRangeAt(0)).deleteContents(),(e=document.createElement("div")).innerHTML=t,n=document.createDocumentFragment(i,o);i=e.firstChild;)o=n.appendChild(i);if(a.insertNode(n),o)return(a=a.cloneRange()).setStartAfter(o),a.collapse(!0),s.removeAllRanges(),s.addRange(a)}}else if(document.selection&&"Control"!==document.selection.type)return document.selection.createRange().pasteHTML(t)},d.prototype.wordFilter=function(t){var l,c,e=t.html();return e=(e=(e=(e=e.replace(/<!--[\s\S]+?-->/gi,"")).replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,"")).replace(/<(\/?)s>/gi,"<$1strike>")).replace(/&nbsp;/gi," "),t.html(e),u("p",t).each(function(){var t=u(this).attr("style"),t=/mso-list:\w+ \w+([0-9]+)/.exec(t);if(t)return u(this).data("_listLevel",parseInt(t[1],10))}),l=0,c=null,u("p",t).each(function(){var t,e,n,o,i,s,a,r=u(this).data("_listLevel");if(void 0===r)return l=0;if(a=u(this).text(),n="<ul></ul>",/^\s*\w+\./.test(a)&&(n=(a=/([0-9])\./.exec(a))?null!=(o=1<(a=parseInt(a[1],10)))?o:'<ol start="'+a+{'"></ol>':"<ol></ol>"}:"<ol></ol>"),l<r&&(c=0===l?(u(this).before(n),u(this).prev()):u(n).appendTo(c)),r<l)for(t=e=i=t,s=l-r;i<=s?e<=s:s<=e;t=i<=s?++e:--e)c=c.parent();return u("span:first",this).remove(),c.append("<li>"+u(this).html()+"</li>"),u(this).remove(),l=r}),u("[style]",t).removeAttr("style"),u("[align]",t).removeAttr("align"),u("span",t).replaceWith(function(){return u(this).contents()}),u("span:empty",t).remove(),u("[class^='Mso']",t).removeAttr("class"),u("p:empty",t).remove(),t},d.prototype.removeAttribute=function(t){var e,n,o,i,s;if(t){for(e=u(t),o=0,i=(s=t.attributes).length;o<i;o++)(n=s[o])&&n.name&&t.removeAttribute(n.name);return e.removeAttr("style").removeAttr("class").removeAttr("lang").removeAttr("type").removeAttr("align").removeAttr("id").removeAttr("wrap").removeAttr("title")}},d.prototype.removeAttributes=function(t,e){var n,o;return(e=null==e?!0:e)&&t.each((n=this,function(t,e){return n.removeAttribute(e)})),t.find("*").each((o=this,function(t,e){return o.removeAttribute(e)})),t},p.ZammadChat=d}(window.jQuery,window),window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.chat=function(t){function e(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?i(t):""}var n=[],o=(t=t||{}).safe,i=t.escape,i=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},i||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){n.push('<div class="zammad-chat'),this.flat&&n.push(e(" zammad-chat--flat")),n.push('"'),this.fontSize&&n.push(e(" style='font-size: "+this.fontSize+"'")),n.push('>\n  <div class="zammad-chat-header js-chat-open"'),this.background&&n.push(e(" style='background: "+this.background+"'")),n.push('>\n    <div class="zammad-chat-header-controls js-chat-toggle">\n      <span class="zammad-chat-agent-status zammad-chat-is-hidden js-chat-status" data-status="online"></span>\n      <span class="zammad-chat-header-icon">\n        <svg class="zammad-chat-header-icon-open" width="13" height="7" viewBox="0 0 13 7"><path d="M10.807 7l1.4-1.428-5-4.9L6.5-.02l-.7.7-4.9 4.9 1.414 1.413L6.5 2.886 10.807 7z" fill-rule="evenodd"/></svg>\n        <svg class="zammad-chat-header-icon-close" width="13" height="13" viewBox="0 0 13 13"><path d="m2.241.12l-2.121 2.121 4.243 4.243-4.243 4.243 2.121 2.121 4.243-4.243 4.243 4.243 2.121-2.121-4.243-4.243 4.243-4.243-2.121-2.121-4.243 4.243-4.243-4.243" fill-rule="evenodd"/></svg>\n      </span>\n    </div>\n    <div class="zammad-chat-agent zammad-chat-is-hidden">\n    </div>\n    <div class="zammad-chat-welcome">\n      <svg class="zammad-chat-icon" viewBox="0 0 24 24" width="24" height="24"><path d="M2 5C2 4 3 3 4 3h16c1 0 2 1 2 2v10C22 16 21 17 20 17H4C3 17 2 16 2 15V5zM12 17l6 4v-4h-6z"/></svg>\n      <span class="zammad-chat-welcome-text">'),n.push(this.T(this.title)),n.push('</span>\n    </div>\n  </div>\n  <div class="zammad-chat-modal"></div>\n  <div class="zammad-scroll-hint is-hidden">\n    <svg class="zammad-scroll-hint-icon" width="20" height="18" viewBox="0 0 20 18"><path d="M0,2.00585866 C0,0.898053512 0.898212381,0 1.99079514,0 L18.0092049,0 C19.1086907,0 20,0.897060126 20,2.00585866 L20,11.9941413 C20,13.1019465 19.1017876,14 18.0092049,14 L1.99079514,14 C0.891309342,14 0,13.1029399 0,11.9941413 L0,2.00585866 Z M10,14 L16,18 L16,14 L10,14 Z" fill-rule="evenodd"/></svg>\n    '),n.push(this.T(this.scrollHint)),n.push('\n  </div>\n  <div class="zammad-chat-body"></div>\n  <form class="zammad-chat-controls">\n    <div class="zammad-chat-input" rows="1" placeholder="'),n.push(this.T("Compose your message…")),n.push('" contenteditable="true"></div>\n    <button type="submit" class="zammad-chat-button zammad-chat-send"'),this.background&&n.push(e(" style='background: "+this.background+"'")),n.push(">"),n.push(this.T("Send")),n.push("</button>\n  </form>\n</div>")}.call(this)}.call(t),t.safe=o,t.escape=i,n.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.customer_timeout=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){var t;e.push('<div class="zammad-chat-modal-text">\n  '),this.agent?(e.push("\n    "),e.push(this.T("Since you didn't respond in the last %s minutes your conversation with <strong>%s</strong> was closed.",this.delay,this.agent))):(e.push("\n    "),e.push(this.T("Since you didn't respond in the last %s minutes your conversation was closed.",this.delay))),e.push("\n  "),e.push('\n  <br>\n  <div class="zammad-chat-button js-restart"'),this.background&&e.push((t=" style='background: "+this.background+"'")&&t.ecoSafe?t:void 0!==t&&null!=t?o(t):""),e.push(">"),e.push(this.T("Start new conversation")),e.push("</div>\n</div>")}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.loader=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){e.push('<span class="zammad-chat-loading-animation">\n  <span class="zammad-chat-loading-circle"></span>\n  <span class="zammad-chat-loading-circle"></span>\n  <span class="zammad-chat-loading-circle"></span>\n</span>\n<span class="zammad-chat-modal-text">'),e.push(this.T("Connecting")),e.push("</span>")}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.message=function(t){function e(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?i(t):""}var n=[],o=(t=t||{}).safe,i=t.escape,i=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},i||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){n.push('<div class="zammad-chat-message zammad-chat-message--'),n.push(e(this.from)),n.push(e(this.unreadClass)),n.push('">\n  <span class="zammad-chat-message-body"'),this.background&&"customer"===this.from&&n.push(e(" style='background: "+this.background+"'")),n.push(">"),n.push(this.message),n.push("</span>\n</div>")}.call(this)}.call(t),t.safe=o,t.escape=i,n.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.status=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){e.push('<div class="zammad-chat-status">\n  <div class="zammad-chat-status-inner">\n    '),e.push(this.status),e.push("\n  </div>\n</div>")}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.timestamp=function(t){function e(t){return t&&t.ecoSafe?t:void 0!==t&&null!=t?i(t):""}var n=[],o=(t=t||{}).safe,i=t.escape,i=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},i||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){n.push('<div class="zammad-chat-timestamp"><strong>'),n.push(e(this.label)),n.push("</strong> "),n.push(e(this.time)),n.push("</div>")}.call(this)}.call(t),t.safe=o,t.escape=i,n.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.typingIndicator=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){e.push('<div class="zammad-chat-message zammad-chat-message--typing zammad-chat-message--agent">\n  <span class="zammad-chat-message-body">\n    <span class="zammad-chat-loading-animation">\n      <span class="zammad-chat-loading-circle"></span>\n      <span class="zammad-chat-loading-circle"></span>\n      <span class="zammad-chat-loading-circle"></span>\n    </span>\n  </span>\n</div>')}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.waiting=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){e.push('<div class="zammad-chat-modal-text">\n  <span class="zammad-chat-loading-animation">\n    <span class="zammad-chat-loading-circle"></span>\n    <span class="zammad-chat-loading-circle"></span>\n    <span class="zammad-chat-loading-circle"></span>\n  </span>\n  '),e.push(this.T("All colleagues are busy.")),e.push("<br>\n  "),e.push(this.T("You are on waiting list position <strong>%s</strong>.",this.position)),e.push("\n</div>")}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")},window.zammadChatTemplates||(window.zammadChatTemplates={}),window.zammadChatTemplates.waiting_list_timeout=function(t){var e=[],n=(t=t||{}).safe,o=t.escape,o=(t.safe=function(t){return t&&t.ecoSafe?t:(void 0!==t&&null!=t||(t=""),(t=new String(t)).ecoSafe=!0,t)},o||(t.escape=function(t){return(""+t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}));return function(){!function(){var t;e.push('<div class="zammad-chat-modal-text">\n  '),e.push(this.T("We are sorry, it is taking longer than expected to get a slot. Please try again later or send us an email. Thank you!")),e.push('\n  <br>\n  <div class="zammad-chat-button js-restart"'),this.background&&e.push((t=" style='background: "+this.background+"'")&&t.ecoSafe?t:void 0!==t&&null!=t?o(t):""),e.push(">"),e.push(this.T("Start new conversation")),e.push("</div>\n</div>")}.call(this)}.call(t),t.safe=n,t.escape=o,e.join("")};